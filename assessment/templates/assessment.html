{% extends "base.html" %}
{% block title %}Self-Assessment â€” DIT 2026{% endblock %}

{% block content %}
<div class="assessment-container">
    <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
    </div>
    <div class="progress-text" id="progressText">Step 1 of 2 &mdash; Finding your SAE Level</div>

    <!-- Stage 1: SAE Level Questions -->
    <div id="saeStage" class="stage">
        <div class="stage-sidebar">
            <h2>Step 1: Find Your SAE Level</h2>
            <p class="stage-desc">These questions identify how much AI automates your design workflow. Pick the option that best describes you <em>today</em>.</p>
        </div>
        <div class="stage-main">
            <div id="saeQuestions"></div>
            <div class="nav-buttons">
                <button id="saePrev" class="btn btn-secondary" disabled>Previous</button>
                <button id="saeNext" class="btn btn-primary">Next</button>
            </div>
        </div>
    </div>

    <!-- Stage 2: EPIAS Maturity Questions -->
    <div id="epiasStage" class="stage" style="display:none;">
        <div class="stage-sidebar">
            <h2>Step 2: Find Your Maturity Stage</h2>
            <p class="stage-desc">Based on your answers, you're at <strong id="identifiedLevel"></strong>. Now let's find how mature you are within that level.</p>
        </div>
        <div class="stage-main">
            <div id="epiasQuestions"></div>
            <div class="nav-buttons">
                <button id="epiasPrev" class="btn btn-secondary">Previous</button>
                <button id="epiasNext" class="btn btn-primary">Next</button>
            </div>
        </div>
    </div>

    <!-- Already Completed -->
    <div id="completedStage" class="stage" style="display:none;">
        <div style="text-align:center; padding: 2rem 0;">
            <h2>Assessment Complete</h2>
            <p style="color:var(--text-muted); margin: 0.5rem 0 1.5rem;">You've already completed the assessment.</p>
            <div style="display:flex; gap:1rem; justify-content:center;">
                <a href="/results" class="btn btn-primary">View Results</a>
                <button id="retakeBtn" class="btn btn-secondary">Retake Assessment</button>
            </div>
        </div>
    </div>

    <!-- Loading -->
    <div id="loadingStage" class="stage" style="display:none;">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p>Analyzing your responses...</p>
        </div>
    </div>
</div>

<script>
    // Pass questions from server
    const SAE_QUESTIONS = {{ questions | tojson }};
</script>
<script src="{{ url_for('static', filename='assessment.js') }}"></script>
{% endblock %}
